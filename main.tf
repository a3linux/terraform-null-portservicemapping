locals {
  # Service Port mappings
  # [from_port, to_port, protocol, description]
  # protocal: tcp(6), udp(17), icmp(1), all(-1) or 58(IPV6-ICMP)
  port_service_defaults = {
    all-all = [-1, -1, "-1", "All Protocal"]
    all-tcp = [0, 65535, "tcp", "All TCP"]
    all-ucp = [0, 65535, "ucp", "All UCP"]
    all-icmp = [-1, -1, "icmp", "All IPV4 ICMP"]
    all-ipv6-icmp = [-1, -1, 58, "All IPV6 ICMP"]
    ftp = [21, 21, "tcp", "FTP"]
    dns = [53, 53, "tcp", "DNS(TCP)"]
    dns-udp = [53, 53, "udp", "DNS(UDP)"]
    ssh = [22, 22, "tcp", "SSH"]
    http = [80, 80, "tcp", "HTTP"]
    pop3 = [110, 110, "tcp", "Pop3 mail"]
    ntp = [123, 123, "tcp", "NTP"]
    ntp = [123, 123, "udp", "NTP UDP"]
    https = [443, 443, "tcp", "HTTPS"]
    microsoft-ds = [445, 445, "tcp", "Microsoft DS(Sambda) over TCP"]
    microsoft-ds-udp = [445, 445, "udp", "Microsoft DS(Sambda) over UDP"]
    netbios-ns-udp = [137, 137, "udp", "Netbios Name Service"]
    netbios-ns = [137, 137, "tcp", "Netbios Name Service"]
    netbios-dgm-udp = [138, 138, "udp", "Netbios Datagram"]
    netbios-dgm = [138, 138, "tcp", "Netbios Datagram"]
    netbios-ssn-udp = [139, 139, "udp", "Netbios Session Service"]
    netbios-ssn = [139, 139, "tcp", "Netbios Session Service"]
    imap = [143, 143, "tcp", "IMAP, Internet mail"]
    bgp = [179, 179, "tcp", "Border Gateway Protocol"]
    ldap = [389, 389, "tcp", "LDAP"]
    smtp-ssl = [487, 487, "tcp", "SMTP over SSL"]
    smtp-tls = [587, 587, "tcp", "SMTP over TLS"]
    ssmtp = [465, 465, "tcp", "SMTP over TLS/SSL"]
    ldaps = [636, 636, "tcp", "LDAP Over SSL/TLS"]
    ldaps-udp = [636, 636, "udp", "LDAP Over SSL/TLS UDP"]
    msexchange = [691, 691, "tcp", "Microsoft Exchange"]
    imap-ssl = [993, 993, "tcp", "IMAP over ssl"]
    pop3-ssl = [995, 995, "tcp", "Pop3 over ssl"]
    msrpc = [1025, 1025, "tcp", "Microsoft RPC"]
    openvpn = [1194, 1194, "tcp", "OpenVPN"]
    vnc = [5900, 5900, "tcp", "VNC Server"]
    mssql = [1433, 1433, "tcp", "Microsoft SQL Server"]
    oracledb = [1521, 1521, "tcp", "Oracle Database"]
    mysql = [3306, 3306, "tcp", "MySQL"]
    rdp = [3389, 3389, "tcp", "RDP, remote desktop"]
    postgresql = [5432, 5432, "tcp", "PostgreSQL"]
    redis = [6379, 6379, "tcp", "Redis"]
    memcache = [11211, 11211, "tcp", "MemCache"]
  }

  port_service_mappings = merge(local.port_service_defaults, var.port_service_mappings)
}
